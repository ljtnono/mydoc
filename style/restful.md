> 作为一个java程序员，当然要了解Restful设计规范

## 现状
现阶段的开发模式多以前后端分离形式存在，前后端开发人员需要通过大量API来进行数据交互，如果在交互过程中前后端人员经常遭遇以下问题：<br>
* 前端人员不能快速理解接口字段含义及接口字段变化
* 后端人员想复用某些接口，但是不能快速从接口URL的定义中明确该接口的含义，需要进一步读代码确认
* URL中的英文单词使用五花八门，搜索某个接口不知道具体的关键字
* 请求方法动词如POST GET 随意用
* 完成当前业务接口对接，前端人员经常会询问下一步业务流程的接口定义在哪里，对接形式是什么样的

以上只是前后端人员通过接口交互的一小部分问题，这些问题就好比“牙痛”，不致命，但是在整个软件开发的生命周期内，天天“牙痛”是很要命的，需要解决上述的问题，需要前后端人员都能认知与了解接口设计规范的重要性。

## 什么是REST
在2000年，Roy Fielding提出`Representational State Transfer(REST)`的概念，中文翻译过来“表述性状态传递”，感兴趣的朋友可以去维基百科看看原始概念，乍一看是一个挺抽象的概念，但其实，这个概念就像交通灯规则一样简单，就看如何看待相关规范. 当我们谈及 RESTful 设计规范，多数人能了解设计的大原则，但是不了解小细节，而对这些细节的了解与否，是能否治好"牙痛病"的关键。

## REST术语介绍
资源是某种东西的对象或表示，它具有一些与之相关的数据，并且可以有一组方法对其进行操作。 例如, 动物，学校和员工是资源; 删除，添加，更新是对这些资源执行的相关操作。

## 集合
集合是资源集合，例如，公司是公司资源的集合。

## URL
URL（统一资源定位符）是可以通过其定位资源的路径，并且可以对其执行某些操作。

## 基于Rest的API设计
> 网上一直有关于"最好的Restful API的设计"争论，何为最好，至今没有一个官方的指导。本文总结 RESTful 的设计细节，介绍如何设计出易于理解和使用的 API。在 Restful API 设计标准之上，我们可以为我们的设计增加一些弹性（团队都认可的方式），每个项目的情况不同，最重要的是项目组成员达成一致的Restful API 设计规则，达到高可用即可

url设计通常就是由两部分来组成，即动词 + 名词，在url中，核心的动词只有那么几个，并且含义单一，也许你曾经见过这样的url：
* /getAllUsers
* /createNewCompany
* /updateUserInfo
* /deleteUser?name=zhangsan

这些URL的设计会导致文章开头所说的很多问题，为了解决这些问题，我们需要合理的组织这些动词和名词。

### 动词
动词通常就是5种HTTP方法，对应我们常见的CRUD操作：
* POST：新建（Create）
* GET：读取（Read）
* PUT：更新（Update）
* PATCH：更新（Update），通常很少用到
* DELETE：删除（Delete）

根据HTTP规范，动词一律大写，另外根据RESTful幂等性（多次调用是否会对资源产生影响）原则，我们不能乱用动词，GET/PUT/DELETE是幂等性的，POST/PATCH不是幂等性的。<br>

有些客户端只能使用`GET`和`POST`这两种方法。服务器必须接收`POST`模拟其他三个方法（`PUT`、`PATCH`、`DELET`),这时，客户端发出的HTTP请求，要加上`X-HTTP-Method-Override`属性，告诉服务器应该使用哪一个动词，覆盖`POST`方法。<br>

```http
POST /usrs/12 HTTP/1.1
X-HTTP-Method-Override: PUT
```

上面代码中，`X-HTTP-Method-Override`指定本次请求的方法是`PUT`，而不是`POST`

### 名词
名词就是表示一个资源或者服务，如 /users，/teachers，这里看到我用名词复数的形式描述某一资源，至于用单数还是复数每个人都有自己的见解，我在这里推荐使用复数，因为在现实世界中，资源多数是以集合的形式存在的

### 动词 + 名词
|   资源    |   POST(Create)    |  GET(Read)   | PUT(Update)  | DELETE(Delete) |
| :-------: | :---------------: | :----------: | :----------: | :------------: |
|  /users   |    创建新用户     | 查询所有用户 | 批量更新用户 |  删除所有用户  |
| /users/12 | 方法不被允许(405) | 查询指定用户 | 更新指定用户 |  删除指定用户  |

``` Http
POST /users
GET /users
PUT /users
DELETE /users
GET /users/12
PUT /users/12
DELETE /users/12
```

上述动词 + 名词的组合是不是清晰多了，没有杂乱的动词在 URL 中，大家的理解含义相同

### 版本
我们看到过很多如下 URL 设计，用来区分 API 版本：<br>
```http
POST /v2/users
GET /V1/users/12
```

我们都指向同样的资源 users，URL 中为什么要加版本号呢？ 针对这个问题，答案依旧没有统一标准，如果多个版本的API版本返回数据结果结构一样，那没必要区分版本，如果结构已经发生变化，而且要向下兼容，那版本号是很好的区分方式，而且通过 URL 加版本的方式可以更好的发现资源。

### 过滤/分页/排序
实际的业务场景中会经常对请求资源做条件筛选，分页显示，以及排序，我们不要为这些业务要求创建不同步的 API，我们应该尽量保持 URL 的信息简单，只需添加查询条件参数来实现上述功能，同时符合"望 URL 知意"的原则。

#### 过滤
```http
GET /users/12/posts?state=published
GET /users/12/posts?published=true
```

#### 分页
```http
GET /users?pageNo=1&pageSize=20
```

#### 排序
```http
GET /users?sort=score_desc
```



## 未完待续...

